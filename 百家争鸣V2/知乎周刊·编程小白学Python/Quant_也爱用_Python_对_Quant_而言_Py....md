# Quant_也爱用_Python_对_Quant_而言_Py...

知乎周刊 103

Quant 也爱用 Python

对 Quant 而言 Python 的需求高吗，除 C++ 外还有哪些流行的编程语言？

袁浩瀚

我发现我可以两行答完这个问题：

1．高

2．还有：Python, Java, Matlab, R, Q 和某些公司内部自有语言（如高盛的自有语言）

但是我不希望敷衍了事，如果回答就展开了说，说说我心中最重要的五类语言。这不仅仅是对于一个 Quant 必须的，而是一个丰满的程序员所必备的。在艺术中，艺永远比术重要.在 Quant 相关知识中，intuition 永远比纯 technique 更加重要。

两年前在 Princeton，我和一位研究计算机语言的 PhD 两人吃饭聊天。他的主要研究方向就是新的计算机语言及相关的逻辑学。大神如他一顿饭下来 80%的时间处于放空状态，基本没在关注我，但我得到了我自以为深刻的理念：一种计算机语言是一种对应哲学的体现。

因此，在我看来，有五类语言构建了一个丰满的编程能力强的 Quant 的一切，它们分别是：效率类语言（C、C++、Java 等）、胶水类语言（Python、Ruby 等）、科学类语言（Matlab、R、S 等）、Alpha 演算类语言（Lisp、Clojure 等）、查询类语言（SQL、Q 等）。这是基于我理解浅薄的分类，完全与计算机科学的规范化分类（如面对对象语言、函数类语言）不相容。持不同意见者大可付之一笑。

1．效率类语言（C、C++、Java 等）：老派的 Quant 很多都是 C++高手，特别是 20 世纪 80 年代涌入华尔街的那帮 MIT 的高能物理博士们。在那个年代，可以选择的语言不多。要么就 Fortan，要么就 C/C++了。所以在当时基本上这些语言同时充当着基础架构（infrastructure）和数值计算（比如 Monte Carlo）的双重目的。但是现在各种胶水类语言、科学类语言多了起来，而且由于单机性能越发强悍，效率再也不是唯一的诉求了，因此目前 C++、Java 大量应用于金融系统级的开发和对于效率要求极高的实时定价等领域。从一个 Quant 的角度来看，这类语言最大的特点是快，编程复杂度高，维护难，同时原生语言普遍不支持向量运算。

2．胶水类语言（Python、Ruby 等）：我必须承认，这些语言是新世代 Quant 的福音。在国内工作的时候我目睹并参与了一个将原有的 C++框架全部用 Python 重写的项目，而现在 JP Morgan 这边利率类产品的定价软件也在从 Java 像 Python 转移。实现同样的代码，Python、Ruby 的实现速度比效率类语言快很多，而且在机器速度越来越快的今天，差距已经不是不可接受。这些语言最大的特点是比较快，编程复杂度高，维护相对简单，同时大量的包（比如 NumPy+SciPy）可以轻松实现向量运算。

3．科学类语言（Matlab、R、S 等）：一般而言，科学类语言最大的特点是支持向量运算，同时各种附加数学、统计包极其丰富，但运算速度无法与前两类相比。在一个具体的投资/交易策略、模型投入实际使用前，你需要快速地去实现（Implement）和验证（Back-testing）你的想法。这个时候，科学类语言就有绝对的优势。验证思路有效后，再用效率类语言或胶水类语言开发成系统级组件。你可以理解为科学类语言是用来造概念车的，而前两类语言是用来量产的。而在具体的职业角度，造概念车的这帮人一般是 Pure Quant，而实现量产的很多是 Quant Developer。当然也有两者合一的集大成者。

4．Alpha 演算类语言（Lisp、Clojure 等）：我第一次对这类语言感兴趣，是 2012 年冬天接触硅谷一家科技公司时（Prismatic，人工智能新闻 App），发现他们在用 Clojure，也极力向我推荐 Clojure。Clojure 是基于 Java 封装的语言，可以用 Java 虚拟机执行。但归根结底，Clojure 是 Lisp 这类语言。之前我长期沉迷于过程编程与面对对象等概念之中，第一次接触 Lisp 很不习惯，但后面开始感叹于这类语言之美。我个人感觉目前 Quant 界用这种语言偏少，但是不排除以后流行的可能。

5．查询类语言（SQL、Q 等）：SQL 就不必说了，金融公司很多时候都是使用 Oracle 等关系型数据库，SQL 是基础。而我之前几次面试也遇到了 SQL 的问题。Q 是 Morgan Stanley 为了应对金融中的海量数据而采用的一种非关系型查询语言，特点是极快，有 SQL 的基础可以很快掌握。

全面地说：如果你是做 Pure Quant，整天与交易策略和模型睡觉，那么 2、3 是必需的.如果你是开发为主，或者是 Quant Developer，那么 1、2、5 是必需的.如果你立志让编程不成为你做 Quant 的障碍，那么 1—5 全都是必须掌握或至少了解其思想的。

不管是作为 Quant 还是 Coder，都不可拘泥于语言。语言只是其背后设计哲学的体现。这就等同一个数量金融从业者不可拘泥于产品一样。数量金融的根基永远是供给需求、金钱时间价值这些基本的经济学理论，以及现金流的相关概率这些基本的统计学思想。如果拘泥于术而非艺，那路就会越走越窄。

2013-02-05

Quant 应该学习哪些 Python 知识？

用 Python 的交易员

我更多应该算一个 trader 而不是 quant（虽然对 quant 的一些知识也略懂），下面的答案可能更多是从一个交易员的角度来回答。

想在市场上赚钱，必须同时具备两样能力：

1. 研究：做出正确的能够获利的决策，也就是寻找 Alpha 的能力

2. 交易：基于研究的结果和交易信号，执行相应的下单风控等操作，也就是将 Alpha 落实到你账户盈利上的能力

研究方面

知友 @龙哥 的答案（

http://www.zhihu.com/question/33555640/answer/56820093

）已经覆盖了常用的库，这里就从研究的整体方向上来介绍下：

1. 获取数据：可以选择使用 TuShare、通联、万得等数据工具下载数据，并将原始的数据格式转化为你自己想用的数据格式（可以用 Python 脚本实现），以保存到数据库中

2. 存储数据：几乎绝大部分常用的数据库都提供了 Python 接口，SQL/NoSQL/HDF5 等等多种，最常用的应该是 MySQL 和 Mongo DB，有兴趣学 Q 的也可以直接去用 KDB+，数据库具体会应用的方向包括保存数据、读取数据、数据补全机制、数据变频（TICK 变 K 线等）

3. 数据回测：将数据读取到内存中后（以 NumPy 数组或者 Pandas 序列的形式），进行策略的回测，并对回测结果进行研究（Matplotlib 绘图），或者对参数进行优化（SciPy 等）

4. 建模相关：对数据进行一些统计学检验（stats model）以及机器学习建模（Scikit-Learn）

5. 集成开发环境：在有针对性的 IDE 中实现以上步骤会更加简便快捷（IPython/Spyder）

交易方面

这部分是我的主场了，主要分为两块：

1. 执行交易：对于绝大部分量化策略，都在一定程度上需要自动/半自动的下单功能。

CTA 策略突破入场（秒级延时）

期权做市实时挂撤单（毫秒级延时）

股指期货高频（微秒级延时）

分级基金套利（批量自动下单，延时没有以上几种重要）

Alpha 套利（篮子交易，一般要使用 vwap 等算法）

2. 策略风控：同样一般需要自动或者半自动的风控功能.

期权组合的希腊值风险实时监控对冲

分级基金套利的 beta 净敞口、行业暴露等实时监控对冲

Alpha 套利策略的因子监控

具体需要掌握的知识：

1. 模拟实盘交易的策略回测：将策略重新编写为可以基于数据回放（逐 TICK/逐 K 线）的模式进行回测的程序，模拟实际交易情况，杜绝未来函数的可能性，实盘交易中使用完全相同的程序进行交易，保证实盘和回测的一致性。这块通常需要专门的框架或者程序，比如通联的优矿、掘金、vn.py 框架中的 vn.strategy 等。

2. 实盘交易接口：将想要下的单子通过交易接口发送到经纪商柜台，目前可以实盘直接使用的应该包括掘金（期货）、vn.py 中的 vn.lts（证券、期权）和 vn.ctp（期货）。如果要使用其他的柜台需要自己封装，如恒生、金证等。

3. 其他语言拓展：作为最有名的胶水语言之一，Python 的拓展功能不用绝对是浪费。针对计算瓶颈可以使用 Cython 拓展，针对 API 可以用 boost.python 和 SWIG 进行封装，调用 Matlab 直接运行其中提供的特定算法，使用 COM 接口调用 Excel 自动生成每日交易记录和报表……

4. GUI 程序的开发：相当数量的量化交易依旧需要交易员进行实时监控，除了在 cmd 中不断 print 一些数据外，更合理的方案是开发自己需要的 GUI 界面，重点推荐 PyQt，比在 C++中用 Qt 开发要来得快捷很多，底层运行的也是 C++的代码，速度完全不用担心。一些有特别需求的人也可以考虑开发在浏览器中显示的界面，比如经常想用手机远程监控。

目前就想到这些，回头发现遗漏的再补充。

——————2015 年 8 月 6 日更新——————

个人的 Python 知识体系：

研究方面

1. 期权目前国内的历史数据较少，所以整体上用万得的 API 就足以满足需求，做 CTA 策略研究会从 MC 导出 csv 格式的数据再读取到 Python 中，目前在研究通联的接口，原因无他：方便和性价比。

2. 数据储存主要用 Mongo DB，主要原因同样是方便，既可以用来存历史的行情数据（Tick，K 线），也可以存交易系统的日志，甚至用来保存交易系统参数设置等等，存取数据如同使用 Python 字典一样方便（MySQL 试过用不惯）。

3. 数据回测，比较粗的回测一般就直接在 Spyder 里随手写测试脚本：读取原始数据，用矩阵的形式计算一些变量（技术指标、希腊值），然后用循环逐行跑回测，结果出来后用 Matplotlib 绘图很方便。比较精细的回测会基于 vn.py 中模拟实盘交易的回测框架，在速度上会慢些，但是可以基本杜绝未来函数。

4. 建模相关：这块不是本人的主攻领域，偶尔有需求拿 SciPy 边看文档边写。

5. 集成开发环境：交互式开发写策略回测一般用 Spyder，开发大型程序的时候用 Wing IDE（朋友友情支持的正版，不得不说非常给力），智能提示、自动完成可以大幅提高开发效率。

6. 交易接口：就是我自己开发的

http://vnpy.org/

框架了，期货方面是 CTP 接口，股票和期权方面是华宝的 LTS 接口，熟知大部分底层开发细节（为了封装接口，没办法）。然后针对不同的交易类型、交易策略，针对性地开发一些 Python 函数和算法，在其中实现特殊的简化下单功能（这些上层功能没放到框架中）。

7. Python 语言拓展：必须掌握的是 Cython，提升 Python 计算性能的神器.另外为了封装 API 用的 boost.python，和 SWIG 比起来的主要好处是封装完全使用 C++语言，同时答主也没有在 Java/Perl 中调用封装模块的需求。

8. GUI 开发：PyQt，功能强大，文档也比较全.高性能的实时绘图：PyQtGraph，一些风控分析的图表可以用 Matplotlib（嵌入到 PyQt 中），生成的图表质量更高。

最后

关于 Python 在量化交易领域的地位：

我认为就像 Javascript 现在在 Web 领域的地位一样，Python 现在可以几乎覆盖整个量化交易业务链：从研究到写交易程序，一气呵成（可以叫作全栈 Quant？）。其他的语言总会有这样那样的短板：

C++/C#/Java：适合写交易程序，不适合用来做策略开发

Matlab/R：适合做策略开发，但是在交易执行方面存在不少问题：速度、不稳定等等

Python：速度不如 C++，策略开发不如 Matlab，但其作为胶水语言，使用这样那样的小技巧后，在两个方面都能满足需求

最后也是很多人喜欢问的：Python 确实不适合开发超高频/超低延时（追求的性能提升在微秒级）的交易策略，不过：

1. 在当前时间点，这个需求已经不那么迫切了.

2. 很多资金容量大能赚大钱（不一定是超高的回报率）的策略对延时的要求并没有那么高。

so it's all up to you

2015-08-06

拓展阅读：

Quant 应该学习哪些 Python 知识？ - 亲爱的龙哥的回答 - 知乎

http://www.zhihu.com/question/33555640/answer/56820093