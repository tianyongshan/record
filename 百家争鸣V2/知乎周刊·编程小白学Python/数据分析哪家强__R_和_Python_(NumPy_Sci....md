# 数据分析哪家强__R_和_Python_(NumPy_Sci...

知乎周刊 103

数据分析哪家强?

R 和 Python (NumPy SciPy Pandas) 用于统计学分析，哪个更好？

周则禹

总的概括：

R 主要在学术界流行，Python(NumPy SciPy)在工程方便比较实用。

R 是 S（Splus）的开源版本，或者下一代。发源地在新西兰奥克兰。这个软件的统计背景很浓烈。我这里浓烈的意思是，如果你不熟习统计知识（历史）的话，R 的帮助文档看起来是很累的。由统计背景的人开发。R 的维护组叫 CRAN-R。在生物信息方便，有个叫 Bioconductor 的组织，里面有很多生物信息方面可以用的软件包，他们有一套自己维护的 package 系统。

Python 是个综合语言（这里特指 CPython 解释器），NumPy SciPy 是数值计算的扩展包，Pandas 是主要用来做数据处理（NumPy 依赖），Sympy 做符号计算（类似 Mathematica？）此外还有一些不太成熟的包如 sciki learn，statistical models。成熟度不如 R。但是已经到了可用的水平了。是读计算机的人写的统计包。IPython 更新到 1.0 以后，功能基本完善，其 Notebook 非常强大（感觉就像 Mathematica)而且还是基于 Web，在合作分享方面非常好用。

性能：

大家都说 R 慢，特别是 CS 的人。其实这里主要是两点：一个 R 里面数组的调用都是用复制的，二是 Rscript 慢。三是处理大数据慢。如果 R 用得好的话，R 是不太慢的。具体来说就是 Rscript 用的少，多用命令，跑点小数据。这样的话，实际在跑的都是背后的 fortran 和 C 库。它们都有快二三十年历史了。可谓异常可靠，优化得不能再优化了（指单线程，如果去看源代码会发现许多莫名的常数，用了以后精度高速度快！）。比如一个自己编写一个 R 脚本，loop 套 loop 的那种，那真是想死的心都会有。外加一点，R 处理文本文件很慢！

Python 归根结底还是个有解释器的脚本语言，而且有致命伤——GIL，但 Python 最难能可贵的就是它很容易变得更快。比如 PyPy，Cython，或者直接 Ctypes 挂 C 库。纯 Python 写个原型，然后就开是不断地 profiling 和加速吧。很轻易可以达到和 C 一个数量级的速度，但是写程序、调试的时间少了很多。

并行计算：

R v15 之后有了自带的 parallel 包，用挺轻松的。不过其实就是不停地 fork，或者 mpi，内存消耗挺厉害的。parSapply，parApply 什么的，真是很好用。

Python 虽然有 GIL——并行计算的死敌，但是有 multiprocessing(fork 依赖) ，是可以共享数据的什么的，估计内存消耗方面比 R 好点，数据零散的话 overhead 很多。到了 MPI 的话，mpi4py 还是挺好用的。用 Cython 的话结合 Openmp 可以打破 GIL，但是过程中不能调用 Python 的对象。

学习曲线：

假设什么编程都不会的同学。

R 一开始还是很容易上手的，查到基本的命令，包，直接 print 一下就有结果了。但是如果要自己写算法、优化性能的时候，学习难度陡增。

Python 么，挺好学的，绝大多数的帮助文档都比 R 好了许多。有些包用起来没 R 方便。

扩展资源：

基本上新的统计方法都会有 R 的 package，安装使用都不麻烦。但是基本上都是搞统计的人写的计算机包。所以效能上可能有问号。比较出名的有两个包的管理网站，cran-r 和 bioconductor。 所以搞生化的估计 R 用起来很方便。

Python 的统计计算包们比 R 少，多很年轻，还在不断的开发中。由于是计算机人写的统计包，用起来的时候要多长个心眼。

画图：

R 自带的那些工具就挺好用了，然后还有 Ggplot 这种非常优美的得力工具。

Python 有 Matplotlib，画出来效果感觉比 R 自带的好一些些，而且界面基于 QT，跨平台支持。可能是 R 用得多了，Pyplot 用起来还是不太顺手，觉得其各个组件的统一性不高。

IDE：

Rstudio 非常不错，提供类 Matlab 环境。（用过 Vim-r-plugin，用过 Emacs +ESS 现在用 Vim。）

Windows 下有 Python(x,y) 还有许多商业的工具。（本人现在的 Emacs 环境还不是很顺手~）

建议：

如果只是处理（小）数据的，用 R。结果更可靠，速度可以接受，上手方便，多有现成的命令、程序可以用。

要自己搞个算法、处理大数据、计算量大的，用 Python。开发效率高，一切尽在掌握。

PS：盲目地用 R 的包比盲目地用 Python 的包要更安全。起码 R 会把你指向一篇论文，而 Python 只是指向一堆代码。R 出问题了还有论文作者、审稿人陪葬。

个人经验：

我首先用 Python 实现了一个统计方法，其中用到了 ctypes，multiprocess。

之后一个项目要做方法比较，又用回 R，发现一些 bioconductor 上的包已经默认用 parallel 了。（但那个包还是很慢，一下子把我所有线程都用掉了，导致整个电脑不能使用，看网页非常卡~）

后来用 Python Pandas 做了一些数据整理工作，类似数据库，两三个表来回查、匹配。感觉还是很方便的。虽然这些工作 R 也能做，但估计会慢点，毕竟几十万行的条目了。

整理好之后开始尝试用 Python Matplotlib 画图。Pyplot 作图的方式和 R 差异很大，R 是一条命令画点东西，Pylot 是准备好了以后一起出来。Pyplot 的颜色选择有点蛋疼，默认颜色比较少，之后可用 html 的颜色，但是名字太长了。Pyplot 的 legend 比 R 好用多了，算是半自动化了。Pyplot 画出来后可以自由拉升缩放，然后再保存为图片，这点比 R 好用多了。

——————

2015/02: 最近在重新考量 R，学会了用 Rcpp。 Rcpp 还是挺好写的，相比 Python 的 ctypes 不用写 wrapper 了，性能也杠杠的。data.table 的 fread 读数据也非常快，看来上面的结论有点过时了。

2015/03: 把我以前用 Python 的一个项目用 R 和 Rcpp 重写了。说实话 Rcpp 非常好用，完全省去了写 wrapper 这一步，效率大挺升。一些 sugar function 也用起来得心应手。但是 R 总体体验还是让我有很多顾虑，总感觉这是一个工具，而并不是一门语言。比如 R 没有 lint 这种神器，使得我 debug 时间花费很多。最致命的就是内存管理太差。这次我处理的数据有点大，binary file 就有 5.3G，就算学校 server 有 64G 内存，R 还是没法把它一股脑装进内存（跟我用的 io package 也有关系）。最后我还是割成小份一点点算的。其主要原因就是 R 一般把 int 都当 double，而且喜欢 copy 而不是 reference。最后说一个小发现，用 makeForkCluster 的时候，如果你更新了一个 function，最好重新 makeForkCluster 一下，确保所以 cluster 上的 function 都是最新的。否则出来的结果可能会诡异哦，而且 debug 半天才发现是 function 没有更新。

2015-03-24

Python 在数据分析工作中的地位与 R 语言、SAS、SPSS 比较如何？

Twisted Python

Python 与 R 不同，Python 是一门多功能的语言。数据统计是更多是通过第三方包来实现的。

具体来说，我常用的 Python 在统计上面的 Package 有这样一些：

1.Numpy 与 Scipy。这两个包是 Python 之所以能在数据分析占有一席之地的重要原因。其中 Numpy 封装了基础的矩阵和向量的操作，而 Scipy 则在 Numpy 的基础上提供了更丰富的功能，比如各种统计常用的分布和算法都能迅速的在 Scipy 中找到。

2.Matplotlib。这个 Package 主要是用来提供数据可视化的，其功能强大，生成的图标可以达到印刷品质，在各种学术会议里面出镜率不低。依托于 Python，可定制性相对于其他的图形库更高。还有一个优点是提供互动化的数据分析，可以动态的缩放图表，用做 adhoc analysis 非常合适。

3.Scikit Learn。非常好用的 Machine Learning 库，适合于用于快速定制原型。封装几乎所有的经典算法(神经网络可能是唯一的例外，不过这个有 Pylearn2 来补充)，易用性极高。

4.Python 标准库。这里主要是体现了 Python 处理字符串的优势，由于 Python 多功能的属性和对于正则表达式的良好支持，用于处理 text 是在合适不过的了。

基本上就日常使用就涉及这些。符号运算等等也有 Sympy 和 Theano 等强力第三方库来支持。总结，Python 在你列举这些里面是综合功能最强大的，但是这些功能分散在第三方库里面，没有得到有机的整合，相应的学习成本会较高。

2013-08-08

peng wang

Python 与 R 相比速度要快。Python 可以直接处理上 G 的数据.R 不行，R 分析数据时需要先通过数据库把大数据转化为小数据（通过 groupby）才能交给 R 做分析，因此 R 不可能直接分析行为详单，只能分析统计结果。Python=R+SQL/Hive

R 的优势在于有包罗万象的统计函数可以调用，特别是在时间序列分析方面（主要用在金融分析与趋势预测），无论是经典还是前沿的方法都有相应的包直接使用.相比之下，Python 在这方面贫乏不少。

Python 的优势在于其胶水语言的特性，一些底层用 C 写的算法封装在 Python 包里后性能非常高效（Python 的数据挖掘包 Orange canve 中的决策树分析 50 万用户 10 秒出结果，用 R 几个小时也出不来，8G 内存全部占满）。

总的来说 Python 是一套比较平衡的语言，各方面都可以，而 R 是在统计方面比较突出。但是数据分析其实不仅仅是统计，前期的数据收集、数据处理、数据抽样、数据聚类，以及比较复杂的数据挖掘算法、数据建模等等这些任务，只要是 100M 以上的数据，R 都很难胜任，但是 Python 却基本胜任。

补充一下：

Python 有专门的数据分析包 Pandas 用来完成类似 SQL 的功能，不过 Pandas 是会把数据都 load 到内存里，如果数据太大（2G 以上）需要想办法分 chunk 分析，或者用 pytables/pyh5 转换为 hdf5 格式的文件在硬盘上分析。

另外如果是 Windows 环境的话，建议用 Winpython，上面提到的这些包会自带。当然更丰富的是 Pythonxy 可惜这个只有 32 位的。

SAS 和 SPSS 是商业数据分析软件，本人从来没用过。

2013-11-13

Lisa Lisa

全部用过的人来回答一下：

SPSS 对用户的要求是只要会点击菜单就可以了，有编程窗口但是一般没人用，用户多是受到过一些统计训练的，但不需要高深的分析能力，市场调研用得比较多，统计专业大二一般要求掌握

SAS 内装许多写好的 procedure，而且都是经过 FDA 认证的有保障的东西，所以死贵。好处是权威，坏处是不够灵活，算法更新慢，还有死贵。语法奇怪，不是那种传统意义上做编程的语言。所以循环啊什么的涉及算法的会不那么方便，也不是 Matlab 这种数学语言，所以数学运算很麻烦。除非你买 iml 库，但就是因为权威，所以药厂要用（老大 FDA 认证的啊）还有银行的风控也会用 SAS 还有个好处是大数据处理，内装的 proc sql 还不错，但说实话我更喜欢直接用 mysql。

接下来是 R 开源，所以更新很快，新的理论很快就可以用上，数据处理尤其方便。data frame list 啥的，好想念啊。生物、医药和学校里的研究喜欢用，我想 R 的出现解决了许多非 IT 人需要面对大量编程的困扰，如果我们排序，难道要从 bubble 算法开始吗？所以一开始被人们说 R 是 Matlab 的精简版，但是都用过之后才知道 R 更轻便好学，而且开源啊，免费啊，没那么多跟 Linux 还是 Windows 的兼容问题啊。R 调用 C 可以极大提高 loop 的速度，monte carlo 的时候简直就是天使！我目睹过同事拿 Matlab 连 C 那个费劲哟！总之，如果你是要做有自己想法的，也就是需要自己编程的，强推 R。对了，我的 R 是在 trading floor 学的，所以别说金融不用，现在金融的最前端 R 也是很流行的。

Python 最后说，最近三个月刚开始用，一开始简直是 pain！不得不说 Pandas 的数据处理便捷程度还是比不上 R，但是习惯了就算了。Python 的好处在于可以做很多事情，不仅仅是统计，所以应用面会更广。其他我不知道，数学建模上和 Matlab 非常相似的语法，Win32 module 里和 Office 兼容很棒。既可以做 stand-alone 又可以做大型开发，等等。

另外，说到金融的应用，很多（比 R 更多）quant 的部门都会用 Python，我甚至面试过 hedge fund，就是直接说他们全部用 Python 做的，毕竟如果真要写算法，R 会慢很多，而写 C++的人毕竟 IT 居多。那种数学系写出来的算法他们做不来，而数学系的 C++又没那么好，所以 Python 就有了用武之地。

总之 R 和 SAS 是专业性更强的统计软件，统计专业学生必备。

SPSS 是更大众化的统计软件，完成一些诸如问卷分析、简单回归之类的小问题。 Python 不是统计软件，而是一种可以用来做各种事情的语言。Stata 介于 Spss 和 SAS 之间，编程的时候难受得头发都掉了。

另外，只有 R 和 Python 是开源。开源不仅仅是免费，更重要的，它是由许多人在维护开发的，所以对新的要求新的理论可以很快付诸实践，但风险就是可能有错（不过错误也会很快改正）。所以你如果要绝对正确，用付费的，至少错了还可以打官司（顺便提一下 revolution R 是 R 的付费有担保版本）。如果你喜欢更 flexible 的，用开源（顺便提一下 octave，不过我还是不喜欢 Matlab 系列的语法），如果你用很简单的统计甚至不懂统计，用 SPSS。

如果你只是统计，或者只是自己一个人干活，用 R。如果你是一个公司要做一个大家一起用的平台，并且工作内容涉及到统计以外，用 Python。

其实 R 也可以连 sql、C、C++，关键是精通一门，然后你会发现其他都是浮云……

其实作为 R 和 Python 的重度使用者，我更喜欢 R，但是……公司的平台全部换成 Python 了……

2014-05-18